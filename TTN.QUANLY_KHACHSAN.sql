CREATE DATABASE QUANLY_KHACHSAN_TTN_NHOM11
GO
USE QUANLY_KHACHSAN_TTN_NHOM11
GO

CREATE TABLE VATTU
(
	MA_VT CHAR(10) PRIMARY KEY,
	TEN NVARCHAR(50),
	GIA FLOAT
)
GO
CREATE TABLE LOAIPHONG
(
	MA_LP CHAR(10) PRIMARY KEY,
	GIA FLOAT,
	SONGUOI INT
)
GO
CREATE TABLE CHITIETVATTU
(
	MA_VT CHAR(10) REFERENCES dbo.VATTU(MA_VT),
	MA_LP CHAR(10) REFERENCES dbo.LOAIPHONG(MA_LP),
	SOLUONG INT
)

GO

CREATE TABLE LOAIDICHVU
(
	MA_LDV CHAR(10) PRIMARY KEY,
	LOAIDICHVU VARCHAR(10),
	HESOGIA FLOAT
)
GO
CREATE TABLE DICHVU
(
	MA_DV CHAR(10) PRIMARY KEY,
	MA_LDV CHAR(10) REFERENCES dbo.LOAIDICHVU(MA_LDV),
	TEN NVARCHAR(100),
	GIA FLOAT,
	DONVITINH VARCHAR(10)
)
GO
CREATE TABLE TRANGTHAIPHONG
(
	MA_TTP CHAR(10) PRIMARY KEY ,
	TRANGTHAI NVARCHAR(50),
)
GO
CREATE TABLE PHONG
(
	MA_P CHAR(10) PRIMARY KEY,
	MA_LP CHAR(10) REFERENCES dbo.LOAIPHONG(MA_LP),
	MA_TTP CHAR(10) REFERENCES dbo.TRANGTHAIPHONG(MA_TTP)
)
GO
CREATE TABLE KHACHHANG
(
	MA_KH CHAR(10) PRIMARY KEY,
	HOTEN NVARCHAR(50),
	GIOITINH BIT,
	CMT CHAR(9),
	DIACHI NVARCHAR(50),
	SDT VARCHAR(11),
	EMAIL VARCHAR(50)
)
GO
CREATE TABLE PHIEUDATPHONG
(
	MA_PDP CHAR(10) PRIMARY KEY,
	MA_KH CHAR(10) REFERENCES dbo.KHACHHANG(MA_KH),
	NGAYDEN DATETIME,
	NGAYDI DATETIME,
	TIENDATCOC FLOAT,
	USERNAME NVARCHAR(50),
	TINHTRANG NVARCHAR(50),
	SONGUOI INT
)
GO
CREATE TABLE CHITIETDATPHONG
(
	MA_PDP CHAR(10) REFERENCES dbo.PHIEUDATPHONG(MA_PDP),
	MA_P CHAR(10) REFERENCES dbo.PHONG(MA_P),
)
GO


CREATE TABLE CHITIETDICHVU
(
	MA_DV CHAR(10) REFERENCES dbo.DICHVU(MA_DV),
	MA_PDP CHAR(10) REFERENCES dbo.PHIEUDATPHONG(MA_PDP),
	SOLUONG int
)
GO

CREATE TABLE NHANVIEN
(
	MA_NV CHAR(10) PRIMARY KEY,
	HOTEN NVARCHAR(50),
	NGAYSINH DATE,
	GIOITINH BIT,
	DIACHI NVARCHAR(50),
	SDT VARCHAR(11),
	CHUCVU NVARCHAR(50)
)
GO
CREATE TABLE HETHONG
(
	USENAME VARCHAR(50) PRIMARY KEY,
	MA_NV CHAR(10) REFERENCES dbo.NHANVIEN(MA_NV),
	PASSWORD VARCHAR(50)
)

GO
CREATE TABLE HOADON
(
	MA_HD INT  PRIMARY KEY IDENTITY,
	NGAYTHANHTOAN DATETIME,
	TONGTIEN FLOAT,
	MA_PDP CHAR(10) REFERENCES dbo.PHIEUDATPHONG(MA_PDP),
	MA_KH CHAR(10) REFERENCES dbo.KHACHHANG(MA_KH),
	USERNAME VARCHAR(50) REFERENCES dbo.HETHONG(USENAME)
)
GO
--INSERT BANG VATTU
GO

INSERT dbo.VATTU( MA_VT, TEN, GIA ) VALUES (N'VT01', N'Bàn ủi',5.0000)
INSERT dbo.VATTU( MA_VT, TEN, GIA ) VALUES (N'VT02', N'Giường Đôi',2000.0000)
INSERT dbo.VATTU( MA_VT, TEN, GIA ) VALUES (N'VT03', N'Giường Đơn',1500.0000)
INSERT dbo.VATTU( MA_VT, TEN, GIA ) VALUES (N'VT04', N'Máy Lạnh',12000.0000)
INSERT dbo.VATTU( MA_VT, TEN, GIA ) VALUES (N'VT05', N'Quạt',200.0000)
INSERT dbo.VATTU( MA_VT, TEN, GIA ) VALUES (N'VT05', N'Tivi',20000.0000)
INSERT dbo.VATTU( MA_VT, TEN, GIA ) VALUES (N'VTO6', N'Tủ Lạnh',2000.0000)
--INSERT BANG LOAIPHONG

GO
INSERT dbo.LOAIPHONG( MA_LP, GIA, SONGUOI ) VALUES (N'LP1', 20000.0000, 3)
INSERT dbo.LOAIPHONG( MA_LP, GIA, SONGUOI ) VALUES (N'LP2', 30000.0000, 5)
INSERT dbo.LOAIPHONG( MA_LP, GIA, SONGUOI ) VALUES (N'LP3', 40000.0000, 2)
INSERT dbo.LOAIPHONG( MA_LP, GIA, SONGUOI ) VALUES (N'LP4', 50000.0000, 4)

--INSERT BANG CHITIETVATTU
GO
INSERT dbo.CHITIETVATTU( MA_VT, MA_LP, SOLUONG ) VALUES (N'VT01', N'LP1', 2)
INSERT dbo.CHITIETVATTU( MA_VT, MA_LP, SOLUONG ) VALUES (N'VT01', N'LP3', 1)
INSERT dbo.CHITIETVATTU( MA_VT, MA_LP, SOLUONG ) VALUES (N'VT02', N'LP4', 2)
INSERT dbo.CHITIETVATTU( MA_VT, MA_LP, SOLUONG ) VALUES (N'VT03', N'LP1', 5)
INSERT dbo.CHITIETVATTU( MA_VT, MA_LP, SOLUONG ) VALUES (N'VT05', N'LP2', 3)
INSERT dbo.CHITIETVATTU( MA_VT, MA_LP, SOLUONG ) VALUES (N'VT06', N'LP3', 1)
INSERT dbo.CHITIETVATTU( MA_VT, MA_LP, SOLUONG ) VALUES (N'VT04', N'LP4', 5)
INSERT dbo.CHITIETVATTU( MA_VT, MA_LP, SOLUONG ) VALUES (N'VT04', N'LP1', 4)
INSERT dbo.CHITIETVATTU( MA_VT, MA_LP, SOLUONG ) VALUES (N'VT01', N'LP4', 2)
INSERT dbo.CHITIETVATTU( MA_VT, MA_LP, SOLUONG ) VALUES (N'VT02', N'LP1', 1)
INSERT dbo.CHITIETVATTU( MA_VT, MA_LP, SOLUONG ) VALUES (N'VT02', N'LP2', 1)
INSERT dbo.CHITIETVATTU( MA_VT, MA_LP, SOLUONG ) VALUES (N'VT04', N'LP4', 5)
INSERT dbo.CHITIETVATTU( MA_VT, MA_LP, SOLUONG ) VALUES (N'VT03', N'LP2', 1)

--INSERT BANG LOAI DICH VU
GO 
INSERT dbo.LOAIDICHVU( MA_LDV, LOAIDICHVU, HESOGIA ) VALUES  ( 'LDV01', 'Thường', 1.0)
INSERT dbo.LOAIDICHVU( MA_LDV, LOAIDICHVU, HESOGIA ) VALUES  ( 'LDV02', 'Vip', 2.0)
INSERT dbo.LOAIDICHVU( MA_LDV, LOAIDICHVU, HESOGIA ) VALUES  ( 'LDV03', 'Đã bỏ', 0.0)

--INSERT BANG DICH VU
GO
INSERT dbo.DICHVU ( MA_DV, MA_LDV, TEN, GIA, DONVITINH ) VALUES (N'DV01','LDV01', N'Điểm Tâm', 15000.0000, N'phần')
INSERT dbo.DICHVU ( MA_DV, MA_LDV, TEN, GIA, DONVITINH ) VALUES (N'DV02','LDV02', N'Điểm Tâm', 30000.0000, N'phần')
INSERT dbo.DICHVU ( MA_DV, MA_LDV, TEN, GIA, DONVITINH ) VALUES (N'DV03','LDV01', N'Cơm trưa', 10000.0000, N'phần')
INSERT dbo.DICHVU ( MA_DV, MA_LDV, TEN, GIA, DONVITINH ) VALUES (N'DV04','LDV02', N'Cơm trưa', 20000.0000, N'phần')
INSERT dbo.DICHVU ( MA_DV, MA_LDV, TEN, GIA, DONVITINH ) VALUES (N'DV05','LDV01', N'Cocacola lon', 3500.0000, N'lon')
INSERT dbo.DICHVU ( MA_DV, MA_LDV, TEN, GIA, DONVITINH ) VALUES (N'DV06','LDV02', N'Cocacola lon', 7000.0000, N'lon')
INSERT dbo.DICHVU ( MA_DV, MA_LDV, TEN, GIA, DONVITINH ) VALUES (N'DV07','LDV01', N'Cocacola chai', 5000.0000, N'chai')
INSERT dbo.DICHVU ( MA_DV, MA_LDV, TEN, GIA, DONVITINH ) VALUES (N'DV08','LDV02', N'Cocacola chai', 10000.0000, N'chai')
INSERT dbo.DICHVU ( MA_DV, MA_LDV, TEN, GIA, DONVITINH ) VALUES (N'DV09','LDV01', N'Giặt Ủi', 5000.0000, N'kg')
INSERT dbo.DICHVU ( MA_DV, MA_LDV, TEN, GIA, DONVITINH ) VALUES (N'DV10','LDV01', N'Lavie', 6000.0000, N'chai')

--INSERT BANG TRANGTHAIPHONG
GO

INSERT dbo.TRANGTHAIPHONG( MA_TTP, TRANGTHAI )VALUES  ( 'TTP01', N'Trống'  )
INSERT dbo.TRANGTHAIPHONG( MA_TTP, TRANGTHAI )VALUES  ( 'TTP02', N'Không Trống'  )
INSERT dbo.TRANGTHAIPHONG( MA_TTP, TRANGTHAI )VALUES  ( 'TTP03', N'Đang dọn dẹp'  )
INSERT dbo.TRANGTHAIPHONG( MA_TTP, TRANGTHAI )VALUES  ( 'TTP04', N'Đang sửa chữa'  )
--INSERT BANG PHONG
GO
INSERT dbo.PHONG ( MA_P, MA_LP, MA_TTP ) VALUES (N'A101', N'LP3', N'TTP02')
INSERT dbo.PHONG ( MA_P, MA_LP, MA_TTP ) VALUES (N'A102', N'LP3', N'TTP01')
INSERT dbo.PHONG ( MA_P, MA_LP, MA_TTP ) VALUES (N'A103', N'LP1', N'TTP02')
INSERT dbo.PHONG ( MA_P, MA_LP, MA_TTP ) VALUES (N'A104', N'LP3', N'TTP01')
INSERT dbo.PHONG ( MA_P, MA_LP, MA_TTP ) VALUES (N'A105', N'LP1', N'TTP03')
INSERT dbo.PHONG ( MA_P, MA_LP, MA_TTP ) VALUES (N'A106', N'LP4', N'TTP01')
INSERT dbo.PHONG ( MA_P, MA_LP, MA_TTP ) VALUES (N'A201', N'LP3', N'TTP01')
INSERT dbo.PHONG ( MA_P, MA_LP, MA_TTP ) VALUES (N'A202', N'LP3', N'TTP01')
INSERT dbo.PHONG ( MA_P, MA_LP, MA_TTP ) VALUES (N'A203', N'LP1', N'TTP01')
INSERT dbo.PHONG ( MA_P, MA_LP, MA_TTP ) VALUES (N'A204', N'LP3', N'TTP01')
INSERT dbo.PHONG ( MA_P, MA_LP, MA_TTP ) VALUES (N'A205', N'LP1', N'TTP03')
INSERT dbo.PHONG ( MA_P, MA_LP, MA_TTP ) VALUES (N'A206', N'LP4', N'TTP01')
INSERT dbo.PHONG ( MA_P, MA_LP, MA_TTP ) VALUES (N'A301', N'LP3', N'TTP01')
INSERT dbo.PHONG ( MA_P, MA_LP, MA_TTP ) VALUES (N'A302', N'LP3', N'TTP01')
INSERT dbo.PHONG ( MA_P, MA_LP, MA_TTP ) VALUES (N'A303', N'LP1', N'TTP01')
INSERT dbo.PHONG ( MA_P, MA_LP, MA_TTP ) VALUES (N'A304', N'LP3', N'TTP01')
INSERT dbo.PHONG ( MA_P, MA_LP, MA_TTP ) VALUES (N'A305', N'LP1', N'TTP03')
INSERT dbo.PHONG ( MA_P, MA_LP, MA_TTP ) VALUES (N'A306', N'LP4', N'TTP01')
INSERT dbo.PHONG ( MA_P, MA_LP, MA_TTP ) VALUES (N'A401', N'LP3', N'TTP01')
INSERT dbo.PHONG ( MA_P, MA_LP, MA_TTP ) VALUES (N'A402', N'LP3', N'TTP01')
INSERT dbo.PHONG ( MA_P, MA_LP, MA_TTP ) VALUES (N'A403', N'LP1', N'TTP01')
INSERT dbo.PHONG ( MA_P, MA_LP, MA_TTP ) VALUES (N'A404', N'LP3', N'TTP01')
INSERT dbo.PHONG ( MA_P, MA_LP, MA_TTP ) VALUES (N'A405', N'LP1', N'TTP03')
INSERT dbo.PHONG ( MA_P, MA_LP, MA_TTP ) VALUES (N'A406', N'LP4', N'TTP01')
INSERT dbo.PHONG ( MA_P, MA_LP, MA_TTP ) VALUES (N'B101', N'LP3', N'TTP01')
INSERT dbo.PHONG ( MA_P, MA_LP, MA_TTP ) VALUES (N'B102', N'LP3', N'TTP01')
INSERT dbo.PHONG ( MA_P, MA_LP, MA_TTP ) VALUES (N'B103', N'LP1', N'TTP01')
INSERT dbo.PHONG ( MA_P, MA_LP, MA_TTP ) VALUES (N'B104', N'LP3', N'TTP01')
INSERT dbo.PHONG ( MA_P, MA_LP, MA_TTP ) VALUES (N'B105', N'LP1', N'TTP03')
INSERT dbo.PHONG ( MA_P, MA_LP, MA_TTP ) VALUES (N'B106', N'LP4', N'TTP01')
INSERT dbo.PHONG ( MA_P, MA_LP, MA_TTP ) VALUES (N'B201', N'LP3', N'TTP01')
INSERT dbo.PHONG ( MA_P, MA_LP, MA_TTP ) VALUES (N'B202', N'LP3', N'TTP01')
INSERT dbo.PHONG ( MA_P, MA_LP, MA_TTP ) VALUES (N'B203', N'LP1', N'TTP01')
INSERT dbo.PHONG ( MA_P, MA_LP, MA_TTP ) VALUES (N'B204', N'LP3', N'TTP01')
INSERT dbo.PHONG ( MA_P, MA_LP, MA_TTP ) VALUES (N'B205', N'LP1', N'TTP03')
INSERT dbo.PHONG ( MA_P, MA_LP, MA_TTP ) VALUES (N'B206', N'LP4', N'TTP01')
INSERT dbo.PHONG ( MA_P, MA_LP, MA_TTP ) VALUES (N'B301', N'LP3', N'TTP01')
INSERT dbo.PHONG ( MA_P, MA_LP, MA_TTP ) VALUES (N'B302', N'LP3', N'TTP01')
INSERT dbo.PHONG ( MA_P, MA_LP, MA_TTP ) VALUES (N'B303', N'LP1', N'TTP01')
INSERT dbo.PHONG ( MA_P, MA_LP, MA_TTP ) VALUES (N'B304', N'LP3', N'TTP01')
INSERT dbo.PHONG ( MA_P, MA_LP, MA_TTP ) VALUES (N'B305', N'LP1', N'TTP03')
INSERT dbo.PHONG ( MA_P, MA_LP, MA_TTP ) VALUES (N'B306', N'LP4', N'TTP01')
INSERT dbo.PHONG ( MA_P, MA_LP, MA_TTP ) VALUES (N'B401', N'LP3', N'TTP01')
INSERT dbo.PHONG ( MA_P, MA_LP, MA_TTP ) VALUES (N'B402', N'LP3', N'TTP01')
INSERT dbo.PHONG ( MA_P, MA_LP, MA_TTP ) VALUES (N'B403', N'LP1', N'TTP01')
INSERT dbo.PHONG ( MA_P, MA_LP, MA_TTP ) VALUES (N'B404', N'LP3', N'TTP01')
INSERT dbo.PHONG ( MA_P, MA_LP, MA_TTP ) VALUES (N'B405', N'LP1', N'TTP03')
INSERT dbo.PHONG ( MA_P, MA_LP, MA_TTP ) VALUES (N'B406', N'LP4', N'TTP01')

--INSERT BANG KHACHHANG
GO
INSERT dbo.KHACHHANG( MA_KH ,HOTEN ,GIOITINH ,CMT ,DIACHI ,SDT ,EMAIL) VALUES (N'KH001', N'Nguyễn Minh Phương', 1, N'98765432', N'Long An',  N'987654567', N'minhphuong12@sedff')
INSERT dbo.KHACHHANG( MA_KH ,HOTEN ,GIOITINH ,CMT ,DIACHI ,SDT ,EMAIL) VALUES (N'KH002', N'Thành Lương', 1, N'98765432', N'Long An', N'987654567', N'minhphuong12@sedff')
INSERT dbo.KHACHHANG( MA_KH ,HOTEN ,GIOITINH ,CMT ,DIACHI ,SDT ,EMAIL) VALUES (N'KH003', N'Nguyễn Thị Mai', 0, N'3566767788', N'123 Lý Chính Thắng, Q.3',  N'232323', N'mrjone_07@yahoo.com')
INSERT dbo.KHACHHANG( MA_KH ,HOTEN ,GIOITINH ,CMT ,DIACHI ,SDT ,EMAIL) VALUES (N'kh004', N'hung', 1, N'999990091', N'Lý Thường Kiệt, Quận 11',  N'0902685483', N'mrjone_07@yahoo.com')
INSERT dbo.KHACHHANG( MA_KH ,HOTEN ,GIOITINH ,CMT ,DIACHI ,SDT ,EMAIL) VALUES (N'KH005', N'Trọng Hoàng', 1, N'123456', N'Nghệ An', N'43464', N'mrjone_07@yahoo.com')
INSERT dbo.KHACHHANG( MA_KH ,HOTEN ,GIOITINH ,CMT ,DIACHI ,SDT ,EMAIL) VALUES (N'KH006', N'Tâm', 1, N'2323434', N'Cao Lỗ',  N'012234', N'asasdsff')
INSERT dbo.KHACHHANG( MA_KH ,HOTEN ,GIOITINH ,CMT ,DIACHI ,SDT ,EMAIL) VALUES (N'KH007', N'Tý', 1, N'2323434', N'Cao Lỗ', N'012234', N'asasdsff')
INSERT dbo.KHACHHANG( MA_KH ,HOTEN ,GIOITINH ,CMT ,DIACHI ,SDT ,EMAIL) VALUES (N'KH008', N'Mai Xuân Hợp', 1, N'3566767788', N'123 Lý Chính Thắng, Q.3', N'232323', N'mrjone_07@yahoo.com')
INSERT dbo.KHACHHANG( MA_KH ,HOTEN ,GIOITINH ,CMT ,DIACHI ,SDT ,EMAIL) VALUES (N'KH009', N'Trần Văn H', 1, N'6676', N'123 Lý Chính Thắng, Q.3',  N'232323', N'mrjone_07@yahoo.com')
INSERT dbo.KHACHHANG( MA_KH ,HOTEN ,GIOITINH ,CMT ,DIACHI ,SDT ,EMAIL) VALUES (N'KH010', N'Nguyễn Văn Lang', 1, N'123456789', N'Phạm Thế Hiển', N'234567', N'mrjone_07@yahoo.com')
INSERT dbo.KHACHHANG( MA_KH ,HOTEN ,GIOITINH ,CMT ,DIACHI ,SDT ,EMAIL) VALUES (N'Kh011', N'Ngô Tâm Ca', 1, N'1234567', N'Âu Dương Lân', N'23456', N'mrjone_07@yahoo.com')
INSERT dbo.KHACHHANG( MA_KH ,HOTEN ,GIOITINH ,CMT ,DIACHI ,SDT ,EMAIL) VALUES (N'KH012', N'trần Thanh hậu', 0, N'12345678', N'Cao Lỗ', N'43', N'mrjone_07@yahoo.com')
INSERT dbo.KHACHHANG( MA_KH ,HOTEN ,GIOITINH ,CMT ,DIACHI ,SDT ,EMAIL) VALUES (N'KH013', N'Vũ Huy Tuấn', 0, N'7654321', N'Lỗ Cao',  N'23412321', N'mrjone_07@yahoo.com')
INSERT dbo.KHACHHANG( MA_KH ,HOTEN ,GIOITINH ,CMT ,DIACHI ,SDT ,EMAIL) VALUES (N'KH014', N'Nguyễn Thị CD', 0, N'3566767788', N'123 Lý Chính Thắng, Q.3', N'232323', N'mrjone_07@yahoo.com')
INSERT dbo.KHACHHANG( MA_KH ,HOTEN ,GIOITINH ,CMT ,DIACHI ,SDT ,EMAIL) VALUES (N'KH015', N'Bùi Tú San', 0, N'23456789', N'Dương Bá Trạc', N'2312313421', N'mrjone_07@yahoo.com')
INSERT dbo.KHACHHANG( MA_KH ,HOTEN ,GIOITINH ,CMT ,DIACHI ,SDT ,EMAIL) VALUES (N'KH016', N'Thành mưu', 1, N'123456', N'Bình Thạnh', N'21312313', N'mrjone_07@yahoo.com')
INSERT dbo.KHACHHANG( MA_KH ,HOTEN ,GIOITINH ,CMT ,DIACHI ,SDT ,EMAIL) VALUES (N'KH017', N'Nguyễn Văn A', 0, N'12345678', N'Cao van a',  N'23123123', N'mrjone_07@yahoo.com')
INSERT dbo.KHACHHANG( MA_KH ,HOTEN ,GIOITINH ,CMT ,DIACHI ,SDT ,EMAIL) VALUES (N'KH018', N'Ngọc', 0, N'12345678', N'Cao Lỗ',  N'43', N'mrjone_07@yahoo.com')
INSERT dbo.KHACHHANG( MA_KH ,HOTEN ,GIOITINH ,CMT ,DIACHI ,SDT ,EMAIL) VALUES (N'KH019', N'Nguyễn Thị M', 0, N'3566767788', N'123 Lý Chính Thắng, Q.3', N'232323', N'mrjone_07@yahoo.com')


--INSERT BANG NHANVIEN
GO
INSERT dbo.NHANVIEN( MA_NV ,HOTEN , NGAYSINH ,GIOITINH , DIACHI ,SDT ,CHUCVU) VALUES (N'NV000', N'Đặng Văn Hùng', CAST(0x0000803400000000 AS DateTime), 1, N'45/36/27/2 Cao Lỗ, P.4, Q.8', N'01267064050', N'Bảo vệ')
INSERT dbo.NHANVIEN( MA_NV ,HOTEN , NGAYSINH ,GIOITINH , DIACHI ,SDT ,CHUCVU) VALUES (N'NV001', N'Lý Tuyết Mai', CAST(0x00007EF500000000 AS DateTime), 0, N'123 Lý Thường Kiệt, P.6, Q.5', N'098562898', N'Nhân viên')
INSERT dbo.NHANVIEN( MA_NV ,HOTEN , NGAYSINH ,GIOITINH , DIACHI ,SDT ,CHUCVU) VALUES (N'NV002', N'Nguyễn Thị Kiều Mai', CAST(0x0000726300000000 AS DateTime), 0, N'234 Lý Thái Tổ, Quận 1, TP Hồ Chí Minh', N'098562898', N'Nhân viên')
INSERT dbo.NHANVIEN( MA_NV ,HOTEN , NGAYSINH ,GIOITINH , DIACHI ,SDT ,CHUCVU) VALUES (N'NV003', N'Lý Thị Tuyết Sương', CAST(0x0000787D00000000 AS DateTime), 0, N'234 Lê Văn Lương, Quận 7, TP Hồ Chí Minh', N'098562898', N'Nhân viên')
INSERT dbo.NHANVIEN( MA_NV ,HOTEN , NGAYSINH ,GIOITINH , DIACHI ,SDT ,CHUCVU) VALUES (N'NV004', N'Nguyễn Thị Kim', CAST(0x0000726300000000 AS DateTime), 0, N'234 Lý Thái Tổ, Quận 1, TP Hồ Chí Minh', N'098562898', N'Nhân viên')
INSERT dbo.NHANVIEN( MA_NV ,HOTEN , NGAYSINH ,GIOITINH , DIACHI ,SDT ,CHUCVU) VALUES (N'NV005', N'Bùi Khắc Tuấn', CAST(0x0000851200C4B33C AS DateTime), 1, N'234 Lê Văn Sỹ, Quận 7, TP Hồ Chí Minh', N'098562898', N'Nhân viên')
INSERT dbo.NHANVIEN( MA_NV ,HOTEN , NGAYSINH ,GIOITINH , DIACHI ,SDT ,CHUCVU) VALUES (N'NV006', N'Lê Thị Huyền', CAST(0x0000851200C1249A AS DateTime), 0, N'234 Lê Văn Sỹ, Quận 7, TP Hồ Chí Minh', N'098562898', N'Quản lý')
INSERT dbo.NHANVIEN( MA_NV ,HOTEN , NGAYSINH ,GIOITINH , DIACHI ,SDT ,CHUCVU) VALUES (N'NV007', N'Văn Mai Hương ', CAST(0x00007EF200000000 AS DateTime), 1, N'wswswsw', N'0907876426', N'Quản lý')
INSERT dbo.NHANVIEN( MA_NV ,HOTEN , NGAYSINH ,GIOITINH , DIACHI ,SDT ,CHUCVU) VALUES (N'NV008', N'Cao Văn Nam', CAST(0x0000724600000000 AS DateTime), 1, N'234 Lê Văn Lương, Quận 7, TP Hồ Chí Minh', N'098562898', N'Quản lý')
INSERT dbo.NHANVIEN( MA_NV ,HOTEN , NGAYSINH ,GIOITINH , DIACHI ,SDT ,CHUCVU) VALUES (N'NV008', N'Trần Thanh Hậu', CAST(0x0000803400000000 AS DateTime), 1, N'45//36/27/2 Cao Lỗ, Quận 8, TP Hồ Chí Minh', N'01267064050', N'Quản lý')
INSERT dbo.NHANVIEN( MA_NV ,HOTEN , NGAYSINH ,GIOITINH , DIACHI ,SDT ,CHUCVU) VALUES (N'NV010', N'Ngô Tâm Ca', CAST(0x00007F1800000000 AS DateTime), 1, N'Âu Dương Lân, Quận 8', N'123214242', N'Quản lý')
INSERT dbo.NHANVIEN( MA_NV ,HOTEN , NGAYSINH ,GIOITINH , DIACHI ,SDT ,CHUCVU) VALUES (N'NV011', N'Cao Văn Nam', CAST(0x0000724600000000 AS DateTime), 1, N'234 Lê Văn Lương, Quận 7, TP Hồ Chí Minh', N'098562898', N'Quản lý')
INSERT dbo.NHANVIEN( MA_NV ,HOTEN , NGAYSINH ,GIOITINH , DIACHI ,SDT ,CHUCVU) VALUES (N'NV012', N'Lý Tuyết Mai', CAST(0x00007EF500000000 AS DateTime), 0, N'123 Lý Thường Kiệt, P.6, Q.5', N'098562898', N'Nhân viên')

--INSERT BANG HETHONG

GO
INSERT dbo.HETHONG ( USENAME, MA_NV, PASSWORD )  VALUES (N'HT01', N'NV000', N'admin')
INSERT dbo.HETHONG ( USENAME, MA_NV, PASSWORD ) VALUES (N'HT02', N'NV002', N'admin')
INSERT dbo.HETHONG ( USENAME, MA_NV, PASSWORD ) VALUES (N'HT03', N'NV007', N'admin')
INSERT dbo.HETHONG ( USENAME, MA_NV, PASSWORD ) VALUES (N'HT04', N'NV0010', N'admin')
INSERT dbo.HETHONG ( USENAME, MA_NV, PASSWORD ) VALUES (N'HT05', N'NV006', N'admin')
INSERT dbo.HETHONG ( USENAME, MA_NV, PASSWORD ) VALUES (N'HT06', N'NV008', N'admin')
INSERT dbo.HETHONG ( USENAME, MA_NV, PASSWORD ) VALUES (N'HT07', N'NV005', N'admin')
INSERT dbo.HETHONG ( USENAME, MA_NV, PASSWORD ) VALUES (N'HT08', N'NV003', N'admin')
INSERT dbo.HETHONG ( USENAME, MA_NV, PASSWORD ) VALUES (N'admin', N'NV004', N'admin')
INSERT dbo.HETHONG ( USENAME, MA_NV, PASSWORD ) VALUES (N'HT10', N'NV001', N'admin')
INSERT dbo.HETHONG ( USENAME, MA_NV, PASSWORD ) VALUES (N'HT11', N'NV006', N'admin')
INSERT dbo.HETHONG ( USENAME, MA_NV, PASSWORD ) VALUES (N'HT12', N'NV011', N'admin')
--INSERT BANG PHIEUDATPHONG
GO 
INSERT dbo.PHIEUDATPHONG( MA_PDP ,MA_KH ,NGAYDEN ,NGAYDI ,TIENDATCOC , USERNAME ,TINHTRANG ,SONGUOI ) VALUES (N'PDP001', N'KH001', CAST(0x00009EC50083C866 AS DateTime), CAST(0x00009EC50083C7F0 AS DateTime), 1.0000, N'HT001', N'finish', 1)
INSERT dbo.PHIEUDATPHONG( MA_PDP ,MA_KH ,NGAYDEN ,NGAYDI ,TIENDATCOC , USERNAME ,TINHTRANG ,SONGUOI ) VALUES (N'PDP002', N'KH003', CAST(0x00009EC60083C7F0 AS DateTime), CAST(0x00009EC60083C7F0 AS DateTime), 1.0000, N'admin', N'waitting', 1)
INSERT dbo.PHIEUDATPHONG( MA_PDP ,MA_KH ,NGAYDEN ,NGAYDI ,TIENDATCOC , USERNAME ,TINHTRANG ,SONGUOI ) VALUES (N'PDP003', N'KH005', CAST(0x00009ED30083C7F0 AS DateTime), CAST(0x00009ED30083C7F0 AS DateTime), 1.0000, N'admin', N'waitting', 1)
INSERT dbo.PHIEUDATPHONG( MA_PDP ,MA_KH ,NGAYDEN ,NGAYDI ,TIENDATCOC , USERNAME ,TINHTRANG ,SONGUOI ) VALUES (N'PDP004', N'KH010', CAST(0x00009EC500866BF7 AS DateTime), CAST(0x00009EC500866AF0 AS DateTime), 1.0000, N'HT002', N'finish', 1)
INSERT dbo.PHIEUDATPHONG( MA_PDP ,MA_KH ,NGAYDEN ,NGAYDI ,TIENDATCOC , USERNAME ,TINHTRANG ,SONGUOI ) VALUES (N'PDP005', N'KH012', CAST(0x00009EC600866AF0 AS DateTime), CAST(0x00009EC600866AF0 AS DateTime), 1.0000, N'admin', N'waitting', 1)
INSERT dbo.PHIEUDATPHONG( MA_PDP ,MA_KH ,NGAYDEN ,NGAYDI ,TIENDATCOC , USERNAME ,TINHTRANG ,SONGUOI ) VALUES (N'PDP006', N'KH006', CAST(0x00009EC5009DF67D AS DateTime), CAST(0x00009EC7009DF5E4 AS DateTime), 9.0000, N'Ht003', N'finish', 8)
 
 --INSERT BANG CHITIETDATPHONG
GO
INSERT dbo.CHITIETDATPHONG( MA_PDP, MA_P ) VALUES (N'PDP001', N'A101')
INSERT dbo.CHITIETDATPHONG( MA_PDP, MA_P ) VALUES (N'PDP002', N'A101')
INSERT dbo.CHITIETDATPHONG( MA_PDP, MA_P ) VALUES (N'PDP003', N'A101')
INSERT dbo.CHITIETDATPHONG( MA_PDP, MA_P ) VALUES (N'PDP004', N'A103')
INSERT dbo.CHITIETDATPHONG( MA_PDP, MA_P ) VALUES (N'PDP005', N'A103')
INSERT dbo.CHITIETDATPHONG( MA_PDP, MA_P ) VALUES (N'PDP006', N'A104')
INSERT dbo.CHITIETDATPHONG( MA_PDP, MA_P ) VALUES (N'PDP006', N'A201')
INSERT dbo.CHITIETDATPHONG( MA_PDP, MA_P ) VALUES (N'PDP006', N'B102')

-- INSERT BANG CHITIETDICHVU
GO 
INSERT dbo.CHITIETDICHVU ( MA_DV, MA_PDP ,soluong) VALUES  ( 'DV01','PDP002',1)
INSERT dbo.CHITIETDICHVU ( MA_DV, MA_PDP,soluong ) VALUES  ( 'DV02','PDP004',1)
INSERT dbo.CHITIETDICHVU ( MA_DV, MA_PDP ,soluong) VALUES  ( 'DV04','PDP001',1)
INSERT dbo.CHITIETDICHVU ( MA_DV, MA_PDP ,soluong) VALUES  ( 'DV05','PDP003',1)
INSERT dbo.CHITIETDICHVU ( MA_DV, MA_PDP ,soluong) VALUES  ( 'DV06','PDP006',1)
INSERT dbo.CHITIETDICHVU ( MA_DV, MA_PDP ,soluong) VALUES  ( 'DV03','PDP005',1)
GO


--INSERT HOADON
GO
INSERT dbo.HOADON(NGAYTHANHTOAN , TONGTIEN ,MA_PDP , MA_KH ,USERNAME) VALUES ( CAST(0x00009EC500843F9A AS DateTime), 19999.0000, N'PDP001', N'KH001', N'HT01')
INSERT dbo.HOADON(NGAYTHANHTOAN , TONGTIEN ,MA_PDP , MA_KH ,USERNAME) VALUES ( CAST(0x00009EC50086B8AD AS DateTime), 19999.0000, N'PDP002', N'KH002', N'HT03')
INSERT dbo.HOADON(NGAYTHANHTOAN , TONGTIEN ,MA_PDP , MA_KH ,USERNAME) VALUES ( CAST(0x00009EC5009E7BFF AS DateTime), 249991.0000, N'PDP003', N'KH003', N'HTO4')
INSERT dbo.HOADON(NGAYTHANHTOAN , TONGTIEN ,MA_PDP , MA_KH ,USERNAME) VALUES ( CAST(0x00009EC500843F9A AS DateTime), 19999.0000, N'PDP004', N'KH008', N'HT06')
INSERT dbo.HOADON(NGAYTHANHTOAN , TONGTIEN ,MA_PDP , MA_KH ,USERNAME) VALUES ( CAST(0x00009EC50086B8AD AS DateTime), 19999.0000, N'PDP005', N'KH009', N'HT05')
INSERT dbo.HOADON(NGAYTHANHTOAN , TONGTIEN ,MA_PDP , MA_KH ,USERNAME) VALUES ( CAST(0x00009EC5009E7BFF AS DateTime), 249991.0000, N'PDP006', N'KH006', N'HTO7')

GO
-- TRIGGER XOA NHAN VIEN

CREATE TRIGGER XOANV ON dbo.NHANVIEN INSTEAD OF DELETE 
AS 
DECLARE @MANV CHAR(10) 
BEGIN 
SELECT @MANV=MA_NV FROM DELETED
UPDATE dbo.HOADON
SET USERNAME = NULL
WHERE dbo.HOADON.USERNAME = (SELECT USERNAME FROM dbo.HETHONG WHERE dbo.HETHONG.MA_NV = @MANV )
DELETE dbo.HETHONG WHERE  dbo.HETHONG.MA_NV = @MANV 
DELETE dbo.NHANVIEN WHERE MA_NV=@MANV
END 
GO
-- TRIGGER XOA PHONG
CREATE TRIGGER XOAPHONG ON dbo.PHONG INSTEAD OF DELETE
AS
DECLARE @MAPHONG CHAR(10)
BEGIN
SELECT @MAPHONG = MA_P FROM Deleted
DELETE dbo.CHITIETDATPHONG WHERE MA_P=@MAPHONG
DELETE dbo.PHONG WHERE MA_P=@MAPHONG
END
GO

-- TRIGGER XOA DICH VU

alter TRIGGER XOADV ON dbo.DICHVU INSTEAD OF DELETE
AS
DECLARE @MADICHVU CHAR(10)
BEGIN

SELECT @MADICHVU = MA_DV FROM Deleted
IF(@MADICHVU IN (SELECT ctdv.MA_DV FROM dbo.CHITIETDICHVU as ctdv, dbo.PHIEUDATPHONG AS pdp WHERE ctdv.MA_PDP = pdp.MA_PDP AND pdp.TINHTRANG = 'finish')  )
begin
DELETE dbo.CHITIETDICHVU WHERE MA_DV = @MADICHVU
DELETE dbo.DICHVU WHERE MA_DV = @MADICHVU
ROLLBACK
end
END




GO
SELECT ctdv.MA_DV FROM dbo.CHITIETDICHVU as ctdv, dbo.PHIEUDATPHONG AS pdp WHERE ctdv.MA_PDP = pdp.MA_PDP AND pdp.TINHTRANG = 'finish'
-- TRIGGER INSERT CHITIETDICHVU

CREATE TRIGGER INSERTCTDV ON dbo.CHITIETDICHVU INSTEAD OF INSERT
AS
DECLARE @MA1 CHAR(10),@MA2 CHAR(10)
BEGIN
SELECT @MA1 = MA_DV FROM Inserted
SELECT @MA2 = MA_PDP FROM Inserted
IF((@MA2 IN (SELECT MA_PDP FROM dbo.CHITIETDICHVU ))AND(@MA1 = (SELECT MA_DV FROM dbo.CHITIETDICHVU WHERE MA_PDP=@MA2)))
BEGIN
UPDATE dbo.CHITIETDICHVU
SET
SOLUONG = SOLUONG +1
WHERE dbo.CHITIETDICHVU.MA_PDP = @MA2 
END

END
